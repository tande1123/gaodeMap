<!--
 * @Descripttion: Descripttion
 * @version: version
 * @Author: Do not Edit
 * @Date: 2019-08-09 14:58:57
 * @LastEditors: qiulongwen
 * @LastEditTime: 2019-08-09 15:17:22
 -->
<!-- 卫生保障   120急救状态 -->
<template>
  <div class="first-state">
    <p class="title">
      <span>120急救车出勤统计</span>
    </p>
    <div class="carlist">
      <div class="car" @click="changeTab(1)" :class="{active:tabIndex===1}">
        <p>
          <img src="../../../static/assets/img/wsbz/cq.png" alt="">
        </p>
        <p>{{ambulance.attendance}}</p>
        <p>出勤</p>
      </div>
      <div class="car" @click="changeTab(2)" :class="{active:tabIndex===2}">
        <p>
          <img src="../../../static/assets/img/wsbz/dm.png" alt="">
        </p>
        <p>{{ambulance.await}}</p>
        <p>待命</p>
      </div>
    </div>
  </div>
</template>
<script>
import { mapGetters } from 'vuex'
export default {
  data () {
    return {
      tabIndex: 1,
      ambulance: {
        attendance: 0,
        await: 0,
        backup: 0
      },
      ambulanceList: {
        attendance: [],
        await: [],
        backup: []
      },
      jhcdata: [
        {
          layername: 'labelLayer',
          name: '驿山高尔夫球场',
          X: 114.320892,
          Y: 30.457855,
          typecode: 'end',
          linePoints: '114.295265,30.430401;114.296219,30.430246;114.296127,30.429951;114.29599,30.429422;114.295921,30.429131;114.295975,30.429106;114.296196,30.429964;114.29641,30.430595;114.296997,30.432127;114.297684,30.433945;114.297836,30.434313;114.299049,30.4375;114.299355,30.438316;114.299698,30.439226;114.299698,30.439362;114.299759,30.439522;114.299919,30.440151;114.300179,30.440786;114.300255,30.441019;114.300415,30.441494;114.300537,30.441971;114.300652,30.442577;114.300713,30.44306;114.30072,30.443111;114.300728,30.443333;114.300743,30.443989;114.30069,30.444717;114.300659,30.444944;114.300652,30.445009;114.300598,30.445272;114.300377,30.446241;114.300377,30.446306;114.300232,30.446722;114.299973,30.447718;114.299713,30.448681;114.299522,30.449444;114.299042,30.451944;114.298935,30.452522;114.298767,30.453529;114.298782,30.454102;114.29879,30.454613;114.298874,30.455605;114.297882,30.456156;114.297112,30.456524;114.295555,30.457277;114.29406,30.457996;114.293816,30.458111;114.292015,30.458984;114.292587,30.459972;114.293076,30.460846;114.293839,30.460505;114.297821,30.45878;114.29805,30.458794;114.298729,30.458508;114.299255,30.458311;114.299805,30.458138;114.300308,30.458015;114.30069,30.457937;114.301292,30.457848;114.30159,30.457817;114.301758,30.457809;114.302208,30.457787;114.302681,30.457787;114.303665,30.457838;114.306152,30.458014;114.306847,30.458059;114.309052,30.458206;114.309837,30.458242;114.310677,30.458229;114.312981,30.458141;114.316154,30.457973;114.317429,30.457911;114.318436,30.457882;114.320892,30.457855;114.321182,30.457855;114.323341,30.457865;114.323723,30.457865;114.330185,30.457882;114.332832,30.457882;114.334305,30.457886;114.340195,30.457911;114.342766,30.45797;114.345703,30.458134;114.349541,30.458361;114.351212,30.45845;114.360504,30.458998;;114.360504,30.458998;114.363609,30.459223;114.364037,30.459253;114.365372,30.459358;114.365959,30.4594;114.367668,30.459536;114.380524,30.460501;114.384544,30.46077;114.386421,30.460911;114.386864,30.460955;114.388199,30.461067;114.389458,30.461155;114.389641,30.461166;114.389908,30.461189;114.390892,30.461245;114.393936,30.461357;114.394569,30.46137;114.395981,30.461411;114.3992,30.461571;114.400566,30.461666;114.401848,30.461836;114.405441,30.462473;114.406357,30.462641;114.409386,30.463186;114.41069,30.463415;114.411621,30.463585;114.413185,30.463867;114.413559,30.463934;114.414345,30.464071;114.414696,30.46413;114.415909,30.464344;114.416252,30.464405;114.416779,30.4645;114.41745,30.464622;114.418152,30.464708;114.41877,30.464748;114.422348,30.464869;114.423325,30.464891;114.426552,30.464991;114.427788,30.46505;114.428551,30.465086;114.429688,30.465164;114.43071,30.465252;114.43277,30.465477;114.433594,30.465588;114.434105,30.465656;114.43557,30.465874;114.436104,30.465965;114.438492,30.466412;114.439407,30.466606;114.440971,30.46697;114.44194,30.467222;114.443993,30.467518;114.445358,30.46763;114.445686,30.467678;114.446121,30.46776;114.446487,30.467846;114.446678,30.467905;114.446861,30.46796;114.44706,30.468042;114.44738,30.468178;114.447784,30.468388;114.448196,30.468637;114.448372,30.468767;114.44873,30.469049;114.449013,30.469307;114.449127,30.469427;114.449265,30.469566;114.449448,30.469801;114.449593,30.469999;114.449745,30.470222;114.450012,30.470678;114.450356,30.471275;114.450478,30.471476;114.45063,30.471693;114.45079,30.471893;114.451317,30.472504;114.451591,30.472769;114.451881,30.473024;114.452072,30.473156;114.452316,30.473343;114.452904,30.473715;114.453598,30.474115;114.454277,30.47448;114.454948,30.474913;114.455238,30.475126;114.455566,30.475409;114.455795,30.47562;114.456223,30.476048;114.456245,30.47607;114.456512,30.476372;114.456886,30.476913;114.457291,30.47757;114.457428,30.477886;114.457603,30.478329;114.457817,30.479031;114.457901,30.479395;114.457954,30.479763;114.45797,30.480074;114.457985,30.480669;114.457954,30.481102;114.457909,30.481436;114.45797,30.48181;114.457855,30.482569;114.457855,30.482765;114.457878,30.482933;114.457916,30.483078;114.458,30.483265;114.458092,30.483412;114.458221,30.483589;114.458763,30.484161;114.459091,30.484509;114.459229,30.484613;114.459381,30.484709;114.459518,30.484777;114.459679,30.484827;114.460136,30.484913;114.461296,30.484818;114.461876,30.484787;114.463051,30.484795;114.463715,30.484821;114.464462,30.484821;114.46463,30.484886;114.464752,30.484936;114.465584,30.484961;114.466393,30.485054;114.467285,30.485191;114.46949,30.485689;114.470528,30.485897;114.471565,30.486076;114.473366,30.48642;114.474571,30.486649;114.475838,30.486898;114.476555,30.487013;114.476868,30.487059;114.477539,30.487148;114.478394,30.487253;114.480164,30.487431;114.480621,30.487465;114.48085,30.487486;114.481209,30.487513;114.481323,30.487526;114.481911,30.48756;114.483032,30.487621;114.484268,30.487713;114.484993,30.487801;114.486389,30.487991;114.48671,30.488047;114.487778,30.488237;114.490318,30.488762;114.490944,30.488911;114.491539,30.489002;114.492279,30.489107;114.492462,30.489708;114.492516,30.489878;114.492691,30.491085;114.492859,30.492208;114.492897,30.492477;114.492912,30.492826;114.492882,30.49316;114.495064,30.493082;114.495544,30.493059;114.496628,30.493025;114.496712,30.493015;114.497223,30.49299;114.498619,30.492924;114.499512,30.492905;114.500023,30.492895;114.500153,30.492891;114.501701,30.492842;114.502304,30.492823;114.502785,30.492804;114.502953,30.49279;114.503288,30.492783;114.50528,30.492733;114.505928,30.492739;114.506737,30.492764;114.507904,30.492865;114.508041,30.493456;114.508064,30.493654;114.508118,30.494102;114.508354,30.494713;114.50843,30.494987;114.508446,30.495169;114.508453,30.495512;114.508347,30.496172;114.508354,30.496334;114.508522,30.496775;114.508583,30.496996;114.508621,30.497505;114.508675,30.497911;114.508743,30.498047;114.508934,30.498383;114.509575,30.499393;114.508987,30.49935;114.508377,30.499418;114.508362,30.499367'
        }
      ]
    }
  },
  computed: {
    ...mapGetters(['mapLoaded', 'map', 'symbol', 'mapConfig'])
  },
  methods: {
    changeTab (index) {
      this.tabIndex = index
      this.map.clear()
      switch (index) {
        case 1:
          this.showRoad()
          break
        case 2:
          break
      }
    },
    showRoad () {
      this.map.addPoints(this.jhcdata, {
        x: 'X',
        y: 'Y',
        symbol: (item) => {
          return this.symbol.pictureMarkerSymbols['bcss']
        }
      })
      for (var i = 0; i < this.jhcdata.length; i++) {
        this.map.addlines(this.jhcdata[i].linePoints, {
          symbol: [this.symbol.lineSymbols['lineJhcRed'], this.symbol.lineSymbols['lineJhcRed']]
        })
      }
    }
  },
  mounted () {
    this.$store.dispatch('getAllAmbulance').then(data => {
      let ambulance = {
        attendance: 0,
        await: 0,
        backup: 0
      }
      for (var i = 0; i < data.length; i++) {
        switch (data[i].CARSTATECODE || data[i].carstatecode) {
          case '1':
            ambulance.attendance++
            break
          case '2':
            ambulance.await++
            break
          case '3':
            ambulance.backup++
            break
        }
      }
      this.ambulance = ambulance
    })
    this.$store.dispatch('getAllAmbulanceGPS').then(data => {
      let ambulance = {
        attendance: [],
        await: [],
        backup: []
      }
      for (var i = 0; i < data.length; i++) {
        switch (data[i].CARSTATECODE || data[i].carstatecode) {
          case '1':
            ambulance.attendance.push(data[i])
            break
          case '2':
            ambulance.await.push(data[i])
            break
          case '3':
            ambulance.backup.push(data[i])
            break
        }
      }
      this.ambulanceList = ambulance
    })
  }
}
</script>
<style lang="less" scoped>
@px: 30rem/1920;
.first-state {
  width: 414 * @px;
  // height: 280 * @px;
  background: #fff;
  border-radius: 4 * @px;
  overflow: hidden;
  box-shadow: 0 0 * @px 15 * @px rgba(0, 0, 0, 0.2);
  .title {
    display: flex;
    justify-content: space-between;
    padding-right: 14 * @px;
    height: 40 * @px;
    line-height: 40 * @px;
    color: #fff;
    background: url("../../../static/assets/img/wsbz/headbg.png") center center
      no-repeat;
    font-size: 18 * @px;
    text-indent: 14 * @px;
    overflow: hidden;
    letter-spacing: 2 * @px;
    span:nth-child(1) {
      font-weight: bold;
    }
  }
  .carlist {
    padding: 14 * @px;
    display: flex;
    justify-content: space-between;
    .car {
      width: 50%;
      height: 154 * @px;
      text-align: center;
      font-size: 16 * @px;
      cursor: pointer;
      p {
        img {
          width: 84 * @px;
          height: 84 * @px;
          border-radius: 50%;
          vertical-align: middle;
        }
        &:nth-child(1) {
          margin-top: 10 * @px;
        }
        &:nth-child(2) {
          font-size: 16 * @px;
          font-weight: bold;
          margin-top: 8 * @px;
        }
        &:nth-child(3) {
          font-size: 18 * @px;
          font-weight: bold;
        }
      }
      &:nth-child(1) {
        color: #de9107;
      }
      &:nth-child(2) {
        color: #0ec881;
      }
    }
  }
}
.active {
  width: 50%;
  height: 154 * @px;
  background: url("../../../static/assets/img/wsbz/active.png") no-repeat center
    center;
  background-size: 100% 100%;
}
</style>
